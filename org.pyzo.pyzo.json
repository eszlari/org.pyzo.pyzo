{
  "app-id" : "org.pyzo.pyzo",
  "runtime" : "org.kde.Platform",
  "runtime-version" : "5.11",
  "sdk" : "org.kde.Sdk",
  "command" : "pyzo",
  "finish-args" : [
    "--share=ipc",
    "--socket=x11",
    "--share=network",
    "--device=dri",
    "--socket=wayland",
    "--filesystem=host",
    "--filesystem=xdg-config/kdeglobals:ro",
    "--talk-name=com.canonical.AppMenu.Registrar",
    "--talk-name=com.canonical.AppMenu.Registrar.*"
  ],
  "modules" : [
    {
      "name" : "pyqt5",
      "config-opts" : [
        "--disable-static",
        "--enable-x11"
      ],
      "sources" : [
        {
          "type" : "archive",
          "url" : "https://sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.11.2/PyQt5_gpl-5.11.2.zip",
          "sha256" : "4a83de09fb8e5b094c14a5900c6f1f117c00798a24eaf09377cf469ddd016009"
        },
        {
           "type": "script",
           "commands": [
               "python3 configure.py --assume-shared --confirm-license --no-designer-plugin --no-qml-plugin --sysroot=/app --verbose --qsci-api --qsci-api-destdir=/app/qsci --sipdir=/app/share/sip --sip=/app/bin/sip --sip-incdir=/app/include QMAKE_CFLAGS_RELEASE='-I/usr/include/python3.5m/' QMAKE_CXXFLAGS_RELEASE='-I/usr/include/python3.5m/'"
           ],
           "dest-filename": "configure"
        }
      ],
      "modules" : [
        {
          "name" : "sip",
          "sources" : [
            {
              "type" : "archive",
              "url" : "https://sourceforge.net/projects/pyqt/files/sip/sip-4.19.13/sip-4.19.13.tar.gz",
              "sha256" : "e353a7056599bf5fbd5d3ff9842a6ab2ea3cf4e0304a0f925ec5862907c0d15e"
            },
            {
              "type": "script",
              "commands": [
                  "python3 configure.py --sip-module PyQt5.sip -b ${FLATPAK_DEST}/bin -d ${FLATPAK_DEST}/lib/python3.5/site-packages -e ${FLATPAK_DEST}/include -v ${FLATPAK_DEST}/share/sip --stubsdir=${FLATPAK_DEST}/lib/python3.5/site-packages"
              ],
              "dest-filename": "configure"
            }
          ],
          "cleanup" : [
            "/bin",
            "/include"
          ]
        }
      ]
    },
    {
      "name" : "python3-pyzo",
      "buildsystem" : "simple",
      "build-commands" : [
        "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} pyzo",
        "install -Dm644 org.pyzo.pyzo128x128.png /app/share/icons/hicolor/128x128/apps/org.pyzo.pyzo.png",
        "install -Dm644 org.pyzo.pyzo64x64.png /app/share/icons/hicolor/64x64/apps/org.pyzo.pyzo.png",
        "install -Dm644 org.pyzo.pyzo.desktop /app/share/applications/org.pyzo.pyzo.desktop",
        "install -Dm644 org.pyzo.pyzo.appdata.xml /app/share/appdata/org.pyzo.pyzo.appdata.xml"
      ],
      "sources" : [
        {
          "type" : "file",
          "path" : "org.pyzo.pyzo.desktop"
        },
        {
          "type" : "file",
          "path" : "org.pyzo.pyzo.appdata.xml"
        },
        {
          "type" : "file",
          "path" : "org.pyzo.pyzo64x64.png"
        },
        {
          "type" : "file",
          "path" : "org.pyzo.pyzo128x128.png"
        },
        {
          "type" : "file",
          "url" : "https://files.pythonhosted.org/packages/ee/fb/0115ea50d92f7c2b65d4538a20cec4dda159d1e3b8456ce4a9e4e657fc68/pyzo-4.6.1.tar.gz",
          "sha256" : "556bceed4c6fdf35d93239c29d96f19cf0b3e92f77e5fad9f519d113dd146857"
        }
      ]
    }
  ]
}
